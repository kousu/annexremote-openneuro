#!/usr/bin/env python3

"""
cli client for https://openneuro.org

(this is an alternative to https://github.com/OpenNeuroOrg/openneuro/blob/master/packages/openneuro-cli/)
"""

import os
import openneuro

if __name__ == '__main__':
    token = os.environ.get('OPENNEURO_TOKEN', None)
    client = openneuro.Client(token)
    c = client.files('ds002919') # DEBUG
    from pprint import pprint
    pprint(c)

    import io
    b = io.BytesIO()
    with open(__file__, 'rb') as e: b.write(e.read())
    b.seek(0)
    r = client.upload('ds002919', b, 'path/to/the/other/file/fsd---fuzz.nii.gz')
    print(r)

    r = client.publishDataset('ds002919')
    print(r)

    # progress bars would be good...
    #client.downloadFile('ds002904', 'sub-ecog01/ses-preimp/anat/sub-ecog01_ses-preimp_T1w.nii.gz', 'bigfun.nii')

    client.downloadDataset('ds002904', path="brainstormtutorials13/actuallyheretho")
